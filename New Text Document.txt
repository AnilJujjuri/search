import time
from opcua import Client

# OPC UA connection settings
endpoint_url = "opc.tcp://MYTSL02946.lnties.com:53530/OPCUA/SimulationServer"

# Create OPC UA client
client = Client(endpoint_url)

try:
    # Connect to the OPC UA server
    client.connect()
    print("Connected!")

    # Get the root node
    root = client.get_root_node()

    # Define a function to recursively browse and retrieve node information
    def browse_and_print(node, indent=""):
        # Print the current node's browse name and NodeId
        print(f"{indent}Node Name: {node.get_browse_name().Name}, NodeId: {node.nodeid}")

        # Recursively browse and print child nodes
        for child_node in node.get_children():
            browse_and_print(child_node, indent + "  ")

    # Call the browse_and_print function starting from the root node
    browse_and_print(root)

    # Disconnect from the OPC UA server
    client.disconnect()
    print("Disconnected!")

except Exception as e:
    print(f"Error: {str(e)}")
