import time
from opcua import Client

# OPC UA connection settings
endpoint_url = "opc.tcp://MYTSL02946.lnties.com:53530/OPCUA/SimulationServer"

# Create OPC UA client
client = Client(endpoint_url)

try:
    # Connect to the OPC UA server
    client.connect()
    print("Connected!")

    # Specify the NodeId of the parent node you want to read
    parent_node_id = "ns=3;s=85/0:Simulation"

    # Get the parent node by NodeId
    parent_node = client.get_node(parent_node_id)

    # Browse and read child nodes
    for child_node in parent_node.get_children():
        # Read the value of each child node
        value = child_node.get_value()
        print(f"Node Name: {child_node.get_browse_name().Name}, NodeId: {child_node.nodeid}, Value: {value}")

    # Disconnect from the OPC UA server
    client.disconnect()
    print("Disconnected!")

except Exception as e:
    print(f"Error: {str(e)}")
